name: Recent Activity

on:
  schedule:
    - cron: "*/30 * * * *"   # 30 dakikada bir
  workflow_dispatch:

jobs:
  activity:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Generate Recent Activity
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require("fs");

            const events = await github.rest.activity.listPublicEventsForUser({
              username: "CBYeuler",
              per_page: 10,
            });

            const lines = events.data
              .filter(e => e.type === "PushEvent")
              .map(e => {
                const repo = e.repo.name;
                const msg = e.payload.commits[0].message;
                return `- [${repo}]: ${msg}`;
              })
              .join("\n");

            fs.writeFileSync("RECENT.md", lines || "No recent pushes.");
      
      - name: Commit file
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          file_pattern: RECENT.md
          commit_message: "update: recent activity"
